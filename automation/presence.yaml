- alias: 'Presence Stefan Away'
  trigger:
    - platform: state
      entity_id: device_tracker.stefan_iphone_7
      to: 'not_home'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Stefan är nu rapporterad som inte hemma.'
        message: 'Inte hemma'

- alias: 'Presence Stefan Home'
  trigger:
    - platform: state
      entity_id: device_tracker.stefan_iphone_7
      to: 'home'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Stefan är nu rapporterad som hemma.'
        message: 'Hemma'
###############################################################


- alias: 'Presence Stefan Bayesian Home'
  initial_state: 'off'
  trigger:
    - platform: state
      entity_id: binary_sensor.stefan_home
      to: 'on'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Stefan är nu rapporterad som hemma.'
        message: 'via bayesian'

- alias: 'Presence Stefan Bayesian Not Home'
  initial_state: 'off'
  trigger:
    - platform: state
      entity_id: binary_sensor.stefan_home
      to: 'off'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Stefan är nu rapporterad som inte hemma.'
        message: 'via bayesian'

###############################################################

- alias: 'Presence Isa Away'
  trigger:
    - platform: state
      entity_id: device_tracker.isabellas_iphone_6s
      to: 'not_home'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Du är nu rapporterad som inte hemma.'
        message: 'Inte hemma'

- alias: 'Presence Isa Home'
  trigger:
    - platform: state
      entity_id: device_tracker.isabellas_iphone_6s
      to: 'home'
  action:
    - service: notify.ios_isabellas_iphone_6s
      data:
        title: 'Du är nu rapporterad som hemma.'
        message: 'Hemma'


###############################################################

- alias: Presence Force Check Location
  trigger:
    - platform: state
      entity_id: sensor.front_door
      to: 'Open'
    - platform: state
      entity_id: sensor.back_door
      to: 'Open'
    - platform: homeassistant
      event: start
  action:
  # Catch home
  - service: notify.ios_stefan_iphone_7
    data:
      message: "request_location_update"
  - service: notify.ios_isabellas_iphone_6s
    data:
      message: "request_location_update"
  - delay: '00:10:00'
  # catch not_home
  - service: notify.ios_stefan_iphone_7
    data:
      message: "request_location_update"
  - service: notify.ios_isabellas_iphone_6s
    data:
      message: "request_location_update"